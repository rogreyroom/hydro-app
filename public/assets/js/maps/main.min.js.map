{"version":3,"sources":["00-service-worker-reg.js","01-global-vars.js","02-glass.js","03-chart.js","99-test.js","nav.js"],"names":["navigator","window","addEventListener","serviceWorker","then","console","log","registration","scope","err","glassCounter","theGlass","document","querySelector","addGlass","removeGlass","waveU","ctx","getElementById","getContext","chartCanvas","chartPreviousWeek","chartNextWeek","messagePanel","toISOString","slice","chartYearWeek","moment","isoWeek","myStorage","state","localStorage","getItem","localStorageKey","innerHTML","addToGlass","setItem","toggle","removeFromGlass","waveD","getData","yearWeek","chartData","chartX","chartScales","length","i","key","scoreWeek","scoreDate","format","push","weekDay","scoreDay","sort","aDate","bDate","Date","date","forEach","item","value","weekNumber","xScale","yScale","chartY","createChart","chartValues","Chart","type","data","labels","datasets","label","backgroundColor","borderColor","borderWidth","yAxes","ticks","beginAtZero","appendChild","newMessage","createElement","className","msgRemove","firstElementChild","checkWeek","removeChild","msgInfo","isoWeeksInYear","isData","generateChart","week","chartCurrent","currentWeek","nextWeek","previousWeek","feedLocalStorage","db"],"mappings":"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","file":"../main.min.js","sourcesContent":["/* service worker registration */\r\nif ('serviceWorker' in navigator) {\r\n    window.addEventListener('load', function() {\r\n      navigator.serviceWorker.register('serviceworker.js').then(\r\n        function(registration) {\r\n          // Registration was successful\r\n          console.log(\r\n            'ServiceWorker registration successful with scope: ',\r\n            registration.scope,\r\n          );\r\n        },\r\n        function(err) {\r\n          // registration failed :(\r\n          console.log('ServiceWorker registration failed: ', err);\r\n        },\r\n      );\r\n    });\r\n  }","// the glass\r\nconst theGlass = document.querySelector('.water-glass__counter--js');\r\nconst addGlass = document.querySelector('.interactions__btn-add--js');\r\nconst removeGlass = document.querySelector('.interactions__btn-remove--js');\r\n// glass animations\r\nconst waveD = document.querySelector('.wave-down--js');\r\nconst waveU = document.querySelector('.wave-up--js');\r\n// history chart\r\nconst chartCanvas = document.querySelector('#myChart');\r\nconst ctx = document.getElementById('myChart').getContext('2d'); //??? czy tu to dać\r\nconst chartCurrent = document.querySelector('.btn__current--js');\r\nconst chartNextWeek = document.querySelector('.btn__next--js');\r\nconst chartPreviousWeek = document.querySelector('.btn__previous--js');\r\n// chart message\r\nconst messagePanel = document.querySelector('.chart__message--js');\r\n\r\n// local storage key name\r\nconst localStorageKey = `hydro-${new Date().toISOString().slice(0, 10)}`;\r\n\r\n// glass counter\r\nlet glassCounter;\r\n\r\n// current week\r\n// let chartYearWeek = 0;\r\nlet chartYearWeek = moment().isoWeek();\r\n","// read and setup glass counter using local storage\r\nconst myStorage = () => {\r\n  const state = localStorage.getItem(localStorageKey);\r\n  if (state !== null) {\r\n    theGlass.innerHTML = state;\r\n    return state;\r\n  } else {\r\n    localStorage.setItem(localStorageKey, 0);\r\n    theGlass.innerHTML = 0;\r\n    return 0;\r\n  }\r\n};\r\n\r\n// add new glass to local storage. Add animations to the glass\r\nconst addToGlass = () => {\r\n  glassCounter++;\r\n  localStorage.setItem(localStorageKey, glassCounter);\r\n  theGlass.innerHTML = glassCounter;\r\n  waveD.classList.toggle('wave-down--animation');\r\n  waveU.classList.toggle('wave-up--animation');\r\n\r\n  // czy to powinno tu być - tylko jeżeli wykres bedzie zawsze widoczny\r\n  generateChart();\r\n};\r\n\r\n// remove glass from local storage - never go bellow zero. Add animation to the glass\r\nconst removeFromGlass = () => {\r\n  glassCounter--;\r\n  if (glassCounter < 0) {\r\n    glassCounter = 0;\r\n    localStorage.setItem(localStorageKey, glassCounter);\r\n    theGlass.innerHTML = glassCounter;\r\n  } else {\r\n    localStorage.setItem(localStorageKey, glassCounter);\r\n    theGlass.innerHTML = glassCounter;\r\n  }\r\n  waveD.classList.toggle('wave-down--animation');\r\n  waveU.classList.toggle('wave-up--animation');\r\n\r\n  // czy to powinno tu być - tylko jeżeli wykres bedzie zawsze widoczny\r\n  generateChart();\r\n};\r\n\r\n// setup the glassCounter\r\nglassCounter = myStorage();\r\n\r\n// glass actions\r\naddGlass.addEventListener('click', addToGlass);\r\nremoveGlass.addEventListener('click', removeFromGlass);\r\n","// get localStorage data and organize them for the chart\r\nconst getData = yearWeek => {\r\n  const chartData = [];\r\n  const chartX = [];\r\n  const chartY = [];\r\n  let chartScales = {};\r\n\r\n  if (localStorage.length !== null) {\r\n    for (let i = 0; i <= localStorage.length - 1; i++) {\r\n      let localStorageKey = localStorage.key(i);\r\n      if (localStorageKey.slice(0, 5) === 'hydro') {\r\n        let scoreDate = localStorageKey.slice(6, localStorageKey.length);\r\n        let scoreWeek = moment(scoreDate).isoWeek();\r\n        let scoreDay = moment(scoreDate).format('dddd');\r\n\r\n        if (scoreWeek === yearWeek) {\r\n          chartData.push({\r\n            weekDay: scoreDay,\r\n            date: scoreDate,\r\n            value: localStorage.getItem(localStorageKey),\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n    // sort chart data by Date\r\n    chartData.sort((aDate, bDate) => {\r\n      let cDate = new Date(aDate.date);\r\n      let dDate = new Date(bDate.date);\r\n      return cDate - dDate;\r\n    });\r\n\r\n    // create axis arrays\r\n    chartData.forEach(item => {\r\n      chartX.push(item.weekDay);\r\n      chartY.push(item.value);\r\n    });\r\n\r\n    chartScales =\r\n      {\r\n        weekNumber: yearWeek,\r\n        xScale: chartX,\r\n        yScale: chartY,\r\n      } || {};\r\n  }\r\n\r\n  return chartScales;\r\n};\r\n\r\n// createChart\r\nconst createChart = chartValues => {\r\n  const myChart = new Chart(ctx, {\r\n    type: 'bar',\r\n    data: {\r\n      labels: chartValues.xScale,\r\n      datasets: [\r\n        {\r\n          label: `Week: ${chartValues.weekNumber}`,\r\n          data: chartValues.yScale,\r\n          backgroundColor: '#3DC3F3',\r\n          borderColor: '#76C1FB',\r\n          borderWidth: 1,\r\n        },\r\n      ],\r\n    },\r\n    options: {\r\n      scales: {\r\n        yAxes: [\r\n          {\r\n            ticks: {\r\n              beginAtZero: true,\r\n            },\r\n          },\r\n        ],\r\n      },\r\n    },\r\n  });\r\n};\r\n\r\nconst msgInfo = msg => {\r\n  let newMessage = document.createElement('p');\r\n  newMessage.className = 'chart__message-text';\r\n  newMessage.innerHTML = msg;\r\n  messagePanel.appendChild(newMessage);\r\n};\r\n\r\nconst msgRemove = () => {\r\n  if (messagePanel.firstElementChild !== null) {\r\n    messagePanel.removeChild(messagePanel.firstElementChild);\r\n  }\r\n};\r\n\r\nconst checkWeek = () => {\r\n  if (chartYearWeek <= 0) {\r\n    return (chartYearWeek = 1);\r\n  } else if (chartYearWeek > moment().isoWeek()) {\r\n    msgRemove();\r\n    msgInfo('No data for next week.');\r\n    if (chartYearWeek > moment().isoWeeksInYear()) {\r\n      chartYearWeek = moment().isoWeeksInYear();\r\n      return chartYearWeek;\r\n    } else {\r\n      return chartYearWeek;\r\n    }\r\n  } else {\r\n    const isData = getData(chartYearWeek);\r\n    if (chartYearWeek < moment().isoWeek() && isData.yScale.length === 0) {\r\n      msgRemove();\r\n      msgInfo('No data for previous week.');\r\n      return chartYearWeek;\r\n    } else {\r\n      msgRemove();\r\n      return chartYearWeek;\r\n    }\r\n  }\r\n};\r\n\r\nconst nextWeek = () => {\r\n  chartYearWeek++;\r\n  generateChart();\r\n};\r\n\r\nconst currentWeek = () => {\r\n  chartYearWeek = moment().isoWeek();\r\n  generateChart();\r\n};\r\n\r\nconst previousWeek = () => {\r\n  chartYearWeek--;\r\n  generateChart();\r\n};\r\n\r\nconst generateChart = () => {\r\n  const week = checkWeek();\r\n  const chartData = getData(week);\r\n  createChart(chartData);\r\n};\r\n\r\n// chart\r\ngenerateChart();\r\n\r\n// chart actions\r\nchartCurrent.addEventListener('click', currentWeek);\r\nchartNextWeek.addEventListener('click', nextWeek);\r\nchartPreviousWeek.addEventListener('click', previousWeek);\r\n","const feedLocalStorage = () => {\n  const db = [\n    ['hydro-2019-07-01', 5],\n    ['hydro-2019-07-02', 3],\n    ['hydro-2019-07-03', 8],\n    ['hydro-2019-07-04', 2],\n    ['hydro-2019-07-05', 7],\n    ['hydro-2019-07-06', 4],\n    ['hydro-2019-07-07', 1],\n    ['hydro-2019-07-08', 5],\n    ['hydro-2019-07-09', 3],\n    ['hydro-2019-07-10', 8],\n    ['hydro-2019-07-11', 2],\n    ['hydro-2019-07-12', 7],\n    ['hydro-2019-07-13', 4],\n    ['hydro-2019-07-14', 1],\n    ['hydro-2019-07-15', 5],\n    ['hydro-2019-07-16', 3],\n    ['hydro-2019-07-17', 8],\n    ['hydro-2019-07-18', 2],\n    ['hydro-2019-07-19', 7],\n    ['hydro-2019-07-20', 4],\n    ['hydro-2019-07-21', 1],\n  ];\n\n  for (let i = 0; i < db.length; i++) {\n    localStorage.setItem(db[i][0], db[i][1]);\n  }\n};\n\nfeedLocalStorage();\n","// const menuIcon = document.querySelector(\".navigation__icon--js\");\n// const navMenu = document.querySelector(\".navigation__list--js\");\n\n// function toggleNavigation() {\n//   menuIcon.classList.toggle(\"hamburger--close\");\n//   navMenu.classList.toggle(\"navigation__list--active\");\n// }\n\n// menuIcon.addEventListener(\"click\", toggleNavigation);\n"]}